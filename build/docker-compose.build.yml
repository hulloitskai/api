## This docker-compose config file is used to define build processes for the
## images in this repository.

version: "3.7"

services:
  api:
    image: "stevenxie/api:${VERSION}"
    build:
      context: ..
      dockerfile: ./build/api.Dockerfile
      args:
        BUILD_VERSION: "${VERSION}"
      cache_from:
        - stevenxie/api:latest
        - alpine:3.8
    container_name: api

  api_test:
    image: "stevenxie/api-tester:latest"
    build:
      context: ..
      dockerfile: ./build/tester.Dockerfile
      cache_from:
        - stevenxie/api-tester:latest
        - golang:1
    container_name: api_test

  jobs:
    image: "stevenxie/api-jobs:${VERSION}"
    build:
      context: ..
      dockerfile: ./build/jobs.Dockerfile
      args:
        BUILD_VERSION: "${VERSION}"
      cache_from:
        - stevenxie/api-jobs:latest
        - alpine:3.8
    container_name: jobs

  jobs-ui:
    image: "stevenxie/api-jobs-ui:${VERSION}"
    build:
      context: ..
      dockerfile: ./build/jobs-ui.Dockerfile
      args:
        BUILD_VERSION: "${VERSION}"
      cache_from:
        - stevenxie/api-jobs-ui:latest
        - alpine:3.8
    container_name: jobs-ui
